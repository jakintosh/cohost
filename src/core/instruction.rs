/*
    0000_0000 -- ( 0 / 1 )
    0000_0001 -- ( 0 / 1 )
    0000_001X -- ( 0 / 2 )

    0000_01XX -- Call / Return ( 4 / 4 )
           DL -- L = len, D = id

    0000_1XXX -- Jump ( 8 / 8 )
          CRL -- L = len, C = cond?, R = rel?

    0001_XXXX -- Float Operatins ( 12 / 16 )
         0XXX -- Float Arithmetic (8 / 8 )
          DDL -- L = len, D = id
         1XXX -- Float Comparisons ( 4 / 8 )
          DDL -- L = len, D = id

    001X_XXXX -- Unused ( 0 / 32 )

    01XX_XXXX -- Byte Manipulation ( 56 / 64 )
      1X_XXXX -- Integer Operations ( 32 / 32 )
       1_XXXX -- Int Arithmetic ( 16 / 16 )
         DDLL -- L = len, D = id
       0_XXXX -- Int Comparisons ( 16 / 16 )
         DDLL -- L = len, D = id
      0X_XXXX -- Bitwise Ops ( 24 / 32 )
       D_DDLL -- L = len, D = id

    1XXX_XXXX -- Data Operations ( 97 / 128 )

     1XX_XXXX -- Stack Operations ( 64 / 64 )
      FF_TTLL -- F = from, T = to, L = len
      11_11XX -- Drop
           DD -- D = id

     0XX_XXXX -- Memory and IO ( 33 / 64)

      1X_XXXX -- Memory ( 16 / 32 )
       1_XXXX -- Memory ( 16 / 16 )
         DDLL -- D = id, L = Len
       0_XXXX -- Unused ( 0 / 16 )

      0X_XXXX -- IO ( 17 / 32 )
       1_XXXX -- Devices ( 12 / 16 ) [3/4 * 4/4]
         DDLL -- D = id, L = len
       0_XXXX -- DMA ( 5 / 16 ) [1/16 + 1/16 + 3/16]
         DDLL -- D = id, L = len
*/
use super::len::*;

pub enum Ins {
    NoOperation,

    // Stack Operations
    DuplicateData { len: Len64 },
    CopyDataToSwap { len: Len64 },
    CopyDataToReturn { len: Len64 },
    CopyDataToHold { len: Len64 },
    CopySwapToData { len: Len64 },
    DuplicateSwap { len: Len64 },
    CopySwapToReturn { len: Len64 },
    CopySwapToHold { len: Len64 },
    CopyReturnToData { len: Len64 },
    CopyReturnToSwap { len: Len64 },
    DuplicateReturn { len: Len64 },
    CopyReturnToHold { len: Len64 },
    CopyHoldToData { len: Len64 },
    CopyHoldToSwap { len: Len64 },
    CopyHoldToReturn { len: Len64 },
    DropData,
    DropSwap,
    DropReturn,

    // Memory
    Literal { len: Len64 },
    Address { len: Len64 },
    Store { len: Len64 },
    Load { len: Len64 },

    // DMA
    DMARead,
    DMAWrite { len: Len32 },
    DMAPoll,

    // Devices
    DeviceRead { len: Len64 },
    DeviceWrite { len: Len64 },
    DevicePoll { len: Len64 },

    // Branching
    Jump { con: bool, rel: bool, len: Len16 },
    Call { len: Len16 },
    Return { len: Len16 },

    // Int Operations
    Add { len: Len64 },
    Subtract { len: Len64 },
    Multiply { len: Len64 },
    Divide { len: Len64 },
    Greater { len: Len64 },
    Less { len: Len64 },
    Equal { len: Len64 },
    NotEqual { len: Len64 },

    // Bitwise Operations
    And { len: Len64 },
    Or { len: Len64 },
    Xor { len: Len64 },
    Not { len: Len64 },
    ShiftL { len: Len64 },
    ShiftR { len: Len64 },

    // Float Operations
    AddF { len: LenF },
    SubtractF { len: LenF },
    MultiplyF { len: LenF },
    DivideF { len: LenF },
    GreaterF { len: LenF },
    LessF { len: LenF },
}

impl From<u8> for Ins {
    fn from(byte: u8) -> Self {
        match byte {
            0b00000000 => Ins::NoOperation,

            0b00000001 => Ins::NoOperation,

            0b0000001_0 => Ins::NoOperation,
            0b0000001_1 => Ins::NoOperation,

            // Call/Return  -- 000001_IL (instruction, length)
            0b000001_00 => Ins::Call { len: Len16::L8 },
            0b000001_01 => Ins::Call { len: Len16::L16 },
            0b000001_10 => Ins::Return { len: Len16::L16 },
            0b000001_11 => Ins::Return { len: Len16::L16 },

            // Jump         -- 00001_CRL (conditional, relative, length)
            0b00001_000 => Ins::Jump {
                con: false,
                rel: false,
                len: Len16::L8,
            },
            0b00001_001 => Ins::Jump {
                con: false,
                rel: false,
                len: Len16::L16,
            },
            0b00001_010 => Ins::Jump {
                con: false,
                rel: true,
                len: Len16::L8,
            },
            0b00001_011 => Ins::Jump {
                con: false,
                rel: true,
                len: Len16::L16,
            },
            0b00001_100 => Ins::Jump {
                con: true,
                rel: false,
                len: Len16::L8,
            },
            0b00001_101 => Ins::Jump {
                con: true,
                rel: false,
                len: Len16::L16,
            },
            0b00001_110 => Ins::Jump {
                con: true,
                rel: true,
                len: Len16::L8,
            },
            0b00001_111 => Ins::Jump {
                con: true,
                rel: true,
                len: Len16::L16,
            },

            // Float Ops    -- 0001_IIIL (instruction, length)
            0b0001_0000 => Ins::AddF { len: LenF::L32 },
            0b0001_0001 => Ins::AddF { len: LenF::L64 },
            0b0001_0010 => Ins::SubtractF { len: LenF::L32 },
            0b0001_0011 => Ins::SubtractF { len: LenF::L64 },
            0b0001_0100 => Ins::MultiplyF { len: LenF::L32 },
            0b0001_0101 => Ins::MultiplyF { len: LenF::L64 },
            0b0001_0110 => Ins::DivideF { len: LenF::L32 },
            0b0001_0111 => Ins::DivideF { len: LenF::L64 },
            0b0001_1000 => Ins::GreaterF { len: LenF::L32 },
            0b0001_1001 => Ins::GreaterF { len: LenF::L64 },
            0b0001_1010 => Ins::LessF { len: LenF::L32 },
            0b0001_1011 => Ins::LessF { len: LenF::L64 },
            0b0001_1100 => Ins::NoOperation,
            0b0001_1101 => Ins::NoOperation,
            0b0001_1110 => Ins::NoOperation,
            0b0001_1111 => Ins::NoOperation,

            // Unused       -- 001_XXXXX
            0b001_00000 => Ins::NoOperation,
            0b001_00001 => Ins::NoOperation,
            0b001_00010 => Ins::NoOperation,
            0b001_00011 => Ins::NoOperation,
            0b001_00100 => Ins::NoOperation,
            0b001_00101 => Ins::NoOperation,
            0b001_00110 => Ins::NoOperation,
            0b001_00111 => Ins::NoOperation,
            0b001_01000 => Ins::NoOperation,
            0b001_01001 => Ins::NoOperation,
            0b001_01010 => Ins::NoOperation,
            0b001_01011 => Ins::NoOperation,
            0b001_01100 => Ins::NoOperation,
            0b001_01101 => Ins::NoOperation,
            0b001_01110 => Ins::NoOperation,
            0b001_01111 => Ins::NoOperation,
            0b001_10000 => Ins::NoOperation,
            0b001_10001 => Ins::NoOperation,
            0b001_10010 => Ins::NoOperation,
            0b001_10011 => Ins::NoOperation,
            0b001_10100 => Ins::NoOperation,
            0b001_10101 => Ins::NoOperation,
            0b001_10110 => Ins::NoOperation,
            0b001_10111 => Ins::NoOperation,
            0b001_11000 => Ins::NoOperation,
            0b001_11001 => Ins::NoOperation,
            0b001_11010 => Ins::NoOperation,
            0b001_11011 => Ins::NoOperation,
            0b001_11100 => Ins::NoOperation,
            0b001_11101 => Ins::NoOperation,
            0b001_11110 => Ins::NoOperation,
            0b001_11111 => Ins::NoOperation,

            // Byte Ops     -- 01_XXXXXX

            // Bitwise Ops  -- 010_IIILL (instruction, length)
            0b010_00000 => Ins::And { len: Len64::L08 },
            0b010_00001 => Ins::And { len: Len64::L16 },
            0b010_00010 => Ins::And { len: Len64::L32 },
            0b010_00011 => Ins::And { len: Len64::L64 },
            0b010_00100 => Ins::Or { len: Len64::L08 },
            0b010_00101 => Ins::Or { len: Len64::L16 },
            0b010_00110 => Ins::Or { len: Len64::L32 },
            0b010_00111 => Ins::Or { len: Len64::L64 },
            0b010_01000 => Ins::Xor { len: Len64::L08 },
            0b010_01001 => Ins::Xor { len: Len64::L16 },
            0b010_01010 => Ins::Xor { len: Len64::L32 },
            0b010_01011 => Ins::Xor { len: Len64::L64 },
            0b010_01100 => Ins::Not { len: Len64::L08 },
            0b010_01101 => Ins::Not { len: Len64::L16 },
            0b010_01110 => Ins::Not { len: Len64::L32 },
            0b010_01111 => Ins::Not { len: Len64::L64 },
            0b010_10000 => Ins::ShiftL { len: Len64::L08 },
            0b010_10001 => Ins::ShiftL { len: Len64::L16 },
            0b010_10010 => Ins::ShiftL { len: Len64::L32 },
            0b010_10011 => Ins::ShiftL { len: Len64::L64 },
            0b010_10100 => Ins::ShiftR { len: Len64::L08 },
            0b010_10101 => Ins::ShiftR { len: Len64::L16 },
            0b010_10110 => Ins::ShiftR { len: Len64::L32 },
            0b010_10111 => Ins::ShiftR { len: Len64::L64 },
            0b010_11000 => Ins::NoOperation,
            0b010_11001 => Ins::NoOperation,
            0b010_11010 => Ins::NoOperation,
            0b010_11011 => Ins::NoOperation,
            0b010_11100 => Ins::NoOperation,
            0b010_11101 => Ins::NoOperation,
            0b010_11110 => Ins::NoOperation,
            0b010_11111 => Ins::NoOperation,

            // Int Math     -- 011_IIILL (instruction, length)
            0b011_00000 => Ins::Add { len: Len64::L08 },
            0b011_00001 => Ins::Add { len: Len64::L16 },
            0b011_00010 => Ins::Add { len: Len64::L32 },
            0b011_00011 => Ins::Add { len: Len64::L64 },
            0b011_00100 => Ins::Subtract { len: Len64::L08 },
            0b011_00101 => Ins::Subtract { len: Len64::L16 },
            0b011_00110 => Ins::Subtract { len: Len64::L32 },
            0b011_00111 => Ins::Subtract { len: Len64::L64 },
            0b011_01000 => Ins::Multiply { len: Len64::L08 },
            0b011_01001 => Ins::Multiply { len: Len64::L16 },
            0b011_01010 => Ins::Multiply { len: Len64::L32 },
            0b011_01011 => Ins::Multiply { len: Len64::L64 },
            0b011_01100 => Ins::Divide { len: Len64::L08 },
            0b011_01101 => Ins::Divide { len: Len64::L16 },
            0b011_01110 => Ins::Divide { len: Len64::L32 },
            0b011_01111 => Ins::Divide { len: Len64::L64 },
            0b011_10000 => Ins::Greater { len: Len64::L08 },
            0b011_10001 => Ins::Greater { len: Len64::L16 },
            0b011_10010 => Ins::Greater { len: Len64::L32 },
            0b011_10011 => Ins::Greater { len: Len64::L64 },
            0b011_10100 => Ins::Less { len: Len64::L08 },
            0b011_10101 => Ins::Less { len: Len64::L16 },
            0b011_10110 => Ins::Less { len: Len64::L32 },
            0b011_10111 => Ins::Less { len: Len64::L64 },
            0b011_11000 => Ins::Equal { len: Len64::L08 },
            0b011_11001 => Ins::Equal { len: Len64::L16 },
            0b011_11010 => Ins::Equal { len: Len64::L32 },
            0b011_11011 => Ins::Equal { len: Len64::L64 },
            0b011_11100 => Ins::NotEqual { len: Len64::L08 },
            0b011_11101 => Ins::NotEqual { len: Len64::L16 },
            0b011_11110 => Ins::NotEqual { len: Len64::L32 },
            0b011_11111 => Ins::NotEqual { len: Len64::L64 },

            // Data Ops     -- 1xxx_xxxx

            // Memory + IO  -- 10xx_xxxx

            // IO           -- 100x_xxxx

            // DMA          -- 1000_xxxx
            0b1000_0000 => Ins::DMARead,
            0b1000_0001 => Ins::NoOperation,
            0b1000_0010 => Ins::NoOperation,
            0b1000_0011 => Ins::NoOperation,
            0b1000_0100 => Ins::DMAWrite { len: Len32::L08 },
            0b1000_0101 => Ins::DMAWrite { len: Len32::L16 },
            0b1000_0110 => Ins::DMAWrite { len: Len32::L32 },
            0b1000_0111 => Ins::NoOperation,
            0b1000_1000 => Ins::DMAPoll,
            0b1000_1001 => Ins::NoOperation,
            0b1000_1010 => Ins::NoOperation,
            0b1000_1011 => Ins::NoOperation,
            0b1000_1100 => Ins::NoOperation,
            0b1000_1101 => Ins::NoOperation,
            0b1000_1110 => Ins::NoOperation,
            0b1000_1111 => Ins::NoOperation,

            // Devices      -- 1001_xxxx
            0b1001_0000 => Ins::DeviceRead { len: Len64::L08 },
            0b1001_0001 => Ins::DeviceRead { len: Len64::L16 },
            0b1001_0010 => Ins::DeviceRead { len: Len64::L32 },
            0b1001_0011 => Ins::DeviceRead { len: Len64::L64 },
            0b1001_0100 => Ins::DeviceWrite { len: Len64::L08 },
            0b1001_0101 => Ins::DeviceWrite { len: Len64::L16 },
            0b1001_0110 => Ins::DeviceWrite { len: Len64::L32 },
            0b1001_0111 => Ins::DeviceWrite { len: Len64::L64 },
            0b1001_1000 => Ins::DevicePoll { len: Len64::L08 },
            0b1001_1001 => Ins::DevicePoll { len: Len64::L16 },
            0b1001_1010 => Ins::DevicePoll { len: Len64::L32 },
            0b1001_1011 => Ins::DevicePoll { len: Len64::L64 },
            0b1001_1100 => Ins::NoOperation,
            0b1001_1101 => Ins::NoOperation,
            0b1001_1110 => Ins::NoOperation,
            0b1001_1111 => Ins::NoOperation,

            // Memory       -- 101x_xxxx

            // unused       -- 1010_xxxx
            0b1010_0000 => Ins::NoOperation,
            0b1010_0001 => Ins::NoOperation,
            0b1010_0010 => Ins::NoOperation,
            0b1010_0011 => Ins::NoOperation,
            0b1010_0100 => Ins::NoOperation,
            0b1010_0101 => Ins::NoOperation,
            0b1010_0110 => Ins::NoOperation,
            0b1010_0111 => Ins::NoOperation,
            0b1010_1000 => Ins::NoOperation,
            0b1010_1001 => Ins::NoOperation,
            0b1010_1010 => Ins::NoOperation,
            0b1010_1011 => Ins::NoOperation,
            0b1010_1100 => Ins::NoOperation,
            0b1010_1101 => Ins::NoOperation,
            0b1010_1110 => Ins::NoOperation,
            0b1010_1111 => Ins::NoOperation,

            // Memory       -- 1011_xxxx
            0b1011_0000 => Ins::Literal { len: Len64::L08 },
            0b1011_0001 => Ins::Literal { len: Len64::L16 },
            0b1011_0010 => Ins::Literal { len: Len64::L32 },
            0b1011_0011 => Ins::Literal { len: Len64::L64 },
            0b1011_0100 => Ins::Address { len: Len64::L08 },
            0b1011_0101 => Ins::Address { len: Len64::L16 },
            0b1011_0110 => Ins::Address { len: Len64::L32 },
            0b1011_0111 => Ins::Address { len: Len64::L64 },
            0b1011_1000 => Ins::Store { len: Len64::L08 },
            0b1011_1001 => Ins::Store { len: Len64::L16 },
            0b1011_1010 => Ins::Store { len: Len64::L32 },
            0b1011_1011 => Ins::Store { len: Len64::L64 },
            0b1011_1100 => Ins::Load { len: Len64::L08 },
            0b1011_1101 => Ins::Load { len: Len64::L16 },
            0b1011_1110 => Ins::Load { len: Len64::L32 },
            0b1011_1111 => Ins::Load { len: Len64::L64 },

            // Stack Ops    -- 11xx_xxxx
            // Data Stack   -- 1100_xxxx
            0b1100_0000 => Ins::DuplicateData { len: Len64::L08 },
            0b1100_0001 => Ins::DuplicateData { len: Len64::L16 },
            0b1100_0010 => Ins::DuplicateData { len: Len64::L32 },
            0b1100_0011 => Ins::DuplicateData { len: Len64::L64 },
            0b1100_0100 => Ins::CopyDataToSwap { len: Len64::L08 },
            0b1100_0101 => Ins::CopyDataToSwap { len: Len64::L16 },
            0b1100_0110 => Ins::CopyDataToSwap { len: Len64::L32 },
            0b1100_0111 => Ins::CopyDataToSwap { len: Len64::L64 },
            0b1100_1000 => Ins::CopyDataToReturn { len: Len64::L08 },
            0b1100_1001 => Ins::CopyDataToReturn { len: Len64::L16 },
            0b1100_1010 => Ins::CopyDataToReturn { len: Len64::L32 },
            0b1100_1011 => Ins::CopyDataToReturn { len: Len64::L64 },
            0b1100_1100 => Ins::CopyDataToHold { len: Len64::L08 },
            0b1100_1101 => Ins::CopyDataToHold { len: Len64::L16 },
            0b1100_1110 => Ins::CopyDataToHold { len: Len64::L32 },
            0b1100_1111 => Ins::CopyDataToHold { len: Len64::L64 },

            // Swap Stack   -- 1101_xxxx
            0b1101_0000 => Ins::CopySwapToData { len: Len64::L08 },
            0b1101_0001 => Ins::CopySwapToData { len: Len64::L16 },
            0b1101_0010 => Ins::CopySwapToData { len: Len64::L32 },
            0b1101_0011 => Ins::CopySwapToData { len: Len64::L64 },
            0b1101_0100 => Ins::DuplicateSwap { len: Len64::L08 },
            0b1101_0101 => Ins::DuplicateSwap { len: Len64::L16 },
            0b1101_0110 => Ins::DuplicateSwap { len: Len64::L32 },
            0b1101_0111 => Ins::DuplicateSwap { len: Len64::L64 },
            0b1101_1000 => Ins::CopySwapToReturn { len: Len64::L08 },
            0b1101_1001 => Ins::CopySwapToReturn { len: Len64::L16 },
            0b1101_1010 => Ins::CopySwapToReturn { len: Len64::L32 },
            0b1101_1011 => Ins::CopySwapToReturn { len: Len64::L64 },
            0b1101_1100 => Ins::CopySwapToHold { len: Len64::L08 },
            0b1101_1101 => Ins::CopySwapToHold { len: Len64::L16 },
            0b1101_1110 => Ins::CopySwapToHold { len: Len64::L32 },
            0b1101_1111 => Ins::CopySwapToHold { len: Len64::L64 },

            // Return Stack   -- 1110_xxxx
            0b1110_0000 => Ins::CopyReturnToData { len: Len64::L08 },
            0b1110_0001 => Ins::CopyReturnToData { len: Len64::L16 },
            0b1110_0010 => Ins::CopyReturnToData { len: Len64::L32 },
            0b1110_0011 => Ins::CopyReturnToData { len: Len64::L64 },
            0b1110_0100 => Ins::CopyReturnToSwap { len: Len64::L08 },
            0b1110_0101 => Ins::CopyReturnToSwap { len: Len64::L16 },
            0b1110_0110 => Ins::CopyReturnToSwap { len: Len64::L32 },
            0b1110_0111 => Ins::CopyReturnToSwap { len: Len64::L64 },
            0b1110_1000 => Ins::DuplicateReturn { len: Len64::L08 },
            0b1110_1001 => Ins::DuplicateReturn { len: Len64::L16 },
            0b1110_1010 => Ins::DuplicateReturn { len: Len64::L32 },
            0b1110_1011 => Ins::DuplicateReturn { len: Len64::L64 },
            0b1110_1100 => Ins::CopyReturnToHold { len: Len64::L08 },
            0b1110_1101 => Ins::CopyReturnToHold { len: Len64::L16 },
            0b1110_1110 => Ins::CopyReturnToHold { len: Len64::L32 },
            0b1110_1111 => Ins::CopyReturnToHold { len: Len64::L64 },

            // Hold and Drop    -- 1111_xxxx
            0b1111_0000 => Ins::CopyHoldToData { len: Len64::L08 },
            0b1111_0001 => Ins::CopyHoldToData { len: Len64::L16 },
            0b1111_0010 => Ins::CopyHoldToData { len: Len64::L32 },
            0b1111_0011 => Ins::CopyHoldToData { len: Len64::L64 },
            0b1111_0100 => Ins::CopyHoldToSwap { len: Len64::L08 },
            0b1111_0101 => Ins::CopyHoldToSwap { len: Len64::L16 },
            0b1111_0110 => Ins::CopyHoldToSwap { len: Len64::L32 },
            0b1111_0111 => Ins::CopyHoldToSwap { len: Len64::L64 },
            0b1111_1000 => Ins::CopyHoldToReturn { len: Len64::L08 },
            0b1111_1001 => Ins::CopyHoldToReturn { len: Len64::L16 },
            0b1111_1010 => Ins::CopyHoldToReturn { len: Len64::L32 },
            0b1111_1011 => Ins::CopyHoldToReturn { len: Len64::L64 },
            0b1111_1100 => Ins::DropData,
            0b1111_1101 => Ins::DropSwap,
            0b1111_1110 => Ins::DropReturn,
            0b1111_1111 => Ins::NoOperation,
        }
    }
}

pub fn opcode_to_str(byte: u8) -> &'static str {
    match byte {
        // 0b00000_0000,
        // 0b00000_0001,
        // 0b00000_0010,
        // 0b00000_0011,
        0b000001_00 => "CAL8",  // => Ins::Call { len: Len16::L8 },
        0b000001_01 => "CAL16", // => Ins::Call { len: Len16::L16 },
        0b000001_10 => "RTN8",  // => Ins::Return { len: Len16::L16 },
        0b000001_11 => "RTN16", // => Ins::Return { len: Len16::L16 },
        0b00001_000 => "JMP8",  //=> Ins::Jump { con: false, rel: false, len: Len16::L8, },
        0b00001_001 => "JMP16", //=> Ins::Jump { con: false, rel: false, len: Len16::L16, },
        0b00001_010 => "JPR8",  //=> Ins::Jump { con: false, rel: true, len: Len16::L8, },
        0b00001_011 => "JPR16", //=> Ins::Jump { con: false, rel: true, len: Len16::L16, },
        0b00001_100 => "JPC8",  //=> Ins::Jump { con: true, rel: false, len: Len16::L8, },
        0b00001_101 => "JPC16", //=> Ins::Jump { con: true, rel: false, len: Len16::L16, },
        0b00001_110 => "JCR8",  //=> Ins::Jump { con: true, rel: true, len: Len16::L8, },
        0b00001_111 => "JCR16", //=> Ins::Jump { con: true, rel: true, len: Len16::L16, },
        0b0001_0000 => "ADF32", // => Ins::AddF { len: LenF::L32 },
        0b0001_0001 => "ADF64", // => Ins::AddF { len: LenF::L64 },
        0b0001_0010 => "SBF32", // => Ins::SubtractF { len: LenF::L32 },
        0b0001_0011 => "SBF64", // => Ins::SubtractF { len: LenF::L64 },
        0b0001_0100 => "MLF32", // => Ins::MultiplyF { len: LenF::L32 },
        0b0001_0101 => "MLF64", // => Ins::MultiplyF { len: LenF::L64 },
        0b0001_0110 => "DVF32", // => Ins::DivideF { len: LenF::L32 },
        0b0001_0111 => "DVF64", // => Ins::DivideF { len: LenF::L64 },
        0b0001_1000 => "GRF32", // => Ins::GreaterF { len: LenF::L32 },
        0b0001_1001 => "GRF64", // => Ins::GreaterF { len: LenF::L64 },
        0b0001_1010 => "LSF32", // => Ins::LessF { len: LenF::L32 },
        0b0001_1011 => "LSF64", // => Ins::LessF { len: LenF::L64 },
        // 0b0001_1100,
        // 0b0001_1101,
        // 0b0001_1110,
        // 0b0001_1111,
        // 0b001_00000,
        // 0b001_00001,
        // 0b001_00010,
        // 0b001_00011,
        // 0b001_00100,
        // 0b001_00101,
        // 0b001_00110,
        // 0b001_00111,
        // 0b001_01000,
        // 0b001_01001,
        // 0b001_01010,
        // 0b001_01011,
        // 0b001_01100,
        // 0b001_01101,
        // 0b001_01110,
        // 0b001_01111,
        // 0b001_10000,
        // 0b001_10001,
        // 0b001_10010,
        // 0b001_10011,
        // 0b001_10100,
        // 0b001_10101,
        // 0b001_10110,
        // 0b001_10111,
        // 0b001_11000,
        // 0b001_11001,
        // 0b001_11010,
        // 0b001_11011,
        // 0b001_11100,
        // 0b001_11101,
        // 0b001_11110,
        // 0b001_11111,
        0b010_00000 => "AND8",  // => Ins::And { len: Len64::L08 },
        0b010_00001 => "AND16", // => Ins::And { len: Len64::L16 },
        0b010_00010 => "AND32", // => Ins::And { len: Len64::L32 },
        0b010_00011 => "AND64", // => Ins::And { len: Len64::L64 },
        0b010_00100 => "OR8",   // => Ins::Or { len: Len64::L08 },
        0b010_00101 => "OR16",  // => Ins::Or { len: Len64::L16 },
        0b010_00110 => "OR32",  // => Ins::Or { len: Len64::L32 },
        0b010_00111 => "OR64",  // => Ins::Or { len: Len64::L64 },
        0b010_01000 => "XOR8",  // => Ins::Xor { len: Len64::L08 },
        0b010_01001 => "XOR16", // => Ins::Xor { len: Len64::L16 },
        0b010_01010 => "XOR32", // => Ins::Xor { len: Len64::L32 },
        0b010_01011 => "XOR64", // => Ins::Xor { len: Len64::L64 },
        0b010_01100 => "NOT8",  // => Ins::Not { len: Len64::L08 },
        0b010_01101 => "NOT16", // => Ins::Not { len: Len64::L16 },
        0b010_01110 => "NOT32", // => Ins::Not { len: Len64::L32 },
        0b010_01111 => "NOT64", // => Ins::Not { len: Len64::L64 },
        0b010_10000 => "BSL8",  // => Ins::ShiftL { len: Len64::L08 },
        0b010_10001 => "BSL16", // => Ins::ShiftL { len: Len64::L16 },
        0b010_10010 => "BSL32", // => Ins::ShiftL { len: Len64::L32 },
        0b010_10011 => "BSL64", // => Ins::ShiftL { len: Len64::L64 },
        0b010_10100 => "BSR8",  // => Ins::ShiftR { len: Len64::L08 },
        0b010_10101 => "BSR16", // => Ins::ShiftR { len: Len64::L16 },
        0b010_10110 => "BSR32", // => Ins::ShiftR { len: Len64::L32 },
        0b010_10111 => "BSR64", // => Ins::ShiftR { len: Len64::L64 },
        // 0b010_11000,
        // 0b010_11001,
        // 0b010_11010,
        // 0b010_11011,
        // 0b010_11100,
        // 0b010_11101,
        // 0b010_11110,
        // 0b010_11111,
        0b011_00000 => "ADD8",       // => Ins::Add { len: Len64::L08 },
        0b011_00001 => "ADD16",      // => Ins::Add { len: Len64::L16 },
        0b011_00010 => "ADD32",      // => Ins::Add { len: Len64::L32 },
        0b011_00011 => "ADD64",      // => Ins::Add { len: Len64::L64 },
        0b011_00100 => "SUB8",       // => Ins::Subtract { len: Len64::L08 },
        0b011_00101 => "SUB16",      // => Ins::Subtract { len: Len64::L16 },
        0b011_00110 => "SUB32",      // => Ins::Subtract { len: Len64::L32 },
        0b011_00111 => "SUB64",      // => Ins::Subtract { len: Len64::L64 },
        0b011_01000 => "MUL8",       // => Ins::Multiply { len: Len64::L08 },
        0b011_01001 => "MUL16",      // => Ins::Multiply { len: Len64::L16 },
        0b011_01010 => "MUL32",      // => Ins::Multiply { len: Len64::L32 },
        0b011_01011 => "MUL64",      // => Ins::Multiply { len: Len64::L64 },
        0b011_01100 => "DIV8",       // => Ins::Divide { len: Len64::L08 },
        0b011_01101 => "DIV16",      // => Ins::Divide { len: Len64::L16 },
        0b011_01110 => "DIV32",      // => Ins::Divide { len: Len64::L32 },
        0b011_01111 => "DIV64",      // => Ins::Divide { len: Len64::L64 },
        0b011_10000 => "GRT8",       // => Ins::Greater { len: Len64::L08 },
        0b011_10001 => "GRT16",      // => Ins::Greater { len: Len64::L16 },
        0b011_10010 => "GRT32",      // => Ins::Greater { len: Len64::L32 },
        0b011_10011 => "GRT64",      // => Ins::Greater { len: Len64::L64 },
        0b011_10100 => "LST8",       // => Ins::Less { len: Len64::L08 },
        0b011_10101 => "LST16",      // => Ins::Less { len: Len64::L16 },
        0b011_10110 => "LST32",      // => Ins::Less { len: Len64::L32 },
        0b011_10111 => "LST64",      // => Ins::Less { len: Len64::L64 },
        0b011_11000 => "EQU8",       // => Ins::Equal { len: Len64::L08 },
        0b011_11001 => "EQU16",      // => Ins::Equal { len: Len64::L16 },
        0b011_11010 => "EQU32",      // => Ins::Equal { len: Len64::L32 },
        0b011_11011 => "EQU64",      // => Ins::Equal { len: Len64::L64 },
        0b011_11100 => "NEQ8",       // => Ins::NotEqual { len: Len64::L08 },
        0b011_11101 => "NEQ16",      // => Ins::NotEqual { len: Len64::L16 },
        0b011_11110 => "NEQ32",      // => Ins::NotEqual { len: Len64::L32 },
        0b011_11111 => "NEQ64",      // => Ins::NotEqual { len: Len64::L64 },
        0b1000_0000 => "DMA_TEST_1", // => Ins::DMARead,
        // 0b1000_0001,
        // 0b1000_0010,
        // 0b1000_0011,
        0b1000_0100 => "DMA_TEST_2", // => Ins::DMAWrite { len: Len32::L08 },
        0b1000_0101 => "DMA_TEST_3", // => Ins::DMAWrite { len: Len32::L16 },
        0b1000_0110 => "DMA_TEST_4", // => Ins::DMAWrite { len: Len32::L32 },
        // 0b1000_0111,
        0b1000_1000 => "DMA_TEST_5", // => Ins::DMAPoll,
        // 0b1000_1001,
        // 0b1000_1010,
        // 0b1000_1011,
        // 0b1000_1100,
        // 0b1000_1101,
        // 0b1000_1110,
        // 0b1000_1111,
        0b1001_0000 => "DEVICE_TEST_0", // => Ins::DeviceRead { len: Len64::L08 },
        0b1001_0001 => "DEVICE_TEST_1", // => Ins::DeviceRead { len: Len64::L16 },
        0b1001_0010 => "DEVICE_TEST_2", // => Ins::DeviceRead { len: Len64::L32 },
        0b1001_0011 => "DEVICE_TEST_3", // => Ins::DeviceRead { len: Len64::L64 },
        0b1001_0100 => "DEVICE_TEST_4", // => Ins::DeviceWrite { len: Len64::L08 },
        0b1001_0101 => "DEVICE_TEST_5", // => Ins::DeviceWrite { len: Len64::L16 },
        0b1001_0110 => "DEVICE_TEST_6", // => Ins::DeviceWrite { len: Len64::L32 },
        0b1001_0111 => "DEVICE_TEST_7", // => Ins::DeviceWrite { len: Len64::L64 },
        0b1001_1000 => "DEVICE_TEST_8", // => Ins::DevicePoll { len: Len64::L08 },
        0b1001_1001 => "DEVICE_TEST_9", // => Ins::DevicePoll { len: Len64::L16 },
        0b1001_1010 => "DEVICE_TEST_A", // => Ins::DevicePoll { len: Len64::L32 },
        0b1001_1011 => "DEVICE_TEST_B", // => Ins::DevicePoll { len: Len64::L64 },
        // 0b1001_1100,
        // 0b1001_1101,
        // 0b1001_1110,
        // 0b1001_1111,
        // 0b1010_0000,
        // 0b1010_0001,
        // 0b1010_0010,
        // 0b1010_0011,
        // 0b1010_0100,
        // 0b1010_0101,
        // 0b1010_0110,
        // 0b1010_0111,
        // 0b1010_1000,
        // 0b1010_1001,
        // 0b1010_1010,
        // 0b1010_1011,
        // 0b1010_1100,
        // 0b1010_1101,
        // 0b1010_1110,
        // 0b1010_1111,
        0b1011_0000 => "LIT8",  // => Ins::Literal { len: Len64::L08 },
        0b1011_0001 => "LIT16", // => Ins::Literal { len: Len64::L16 },
        0b1011_0010 => "LIT32", // => Ins::Literal { len: Len64::L32 },
        0b1011_0011 => "LIT64", // => Ins::Literal { len: Len64::L64 },
        0b1011_0100 => "ADR8",  // => Ins::Address { len: Len64::L08 },
        0b1011_0101 => "ADR16", // => Ins::Address { len: Len64::L16 },
        0b1011_0110 => "ADR32", // => Ins::Address { len: Len64::L32 },
        0b1011_0111 => "ADR64", // => Ins::Address { len: Len64::L64 },
        0b1011_1000 => "STR8",  // => Ins::Store { len: Len64::L08 },
        0b1011_1001 => "STR16", // => Ins::Store { len: Len64::L16 },
        0b1011_1010 => "STR32", // => Ins::Store { len: Len64::L32 },
        0b1011_1011 => "STR64", // => Ins::Store { len: Len64::L64 },
        0b1011_1100 => "LOD8",  // => Ins::Load { len: Len64::L08 },
        0b1011_1101 => "LOD16", // => Ins::Load { len: Len64::L16 },
        0b1011_1110 => "LOD32", // => Ins::Load { len: Len64::L32 },
        0b1011_1111 => "LOD64", // => Ins::Load { len: Len64::L64 },
        0b1100_0000 => "DPD8",  // => Ins::DuplicateData { len: Len64::L08 },
        0b1100_0001 => "DPD16", // => Ins::DuplicateData { len: Len64::L16 },
        0b1100_0010 => "DPD32", // => Ins::DuplicateData { len: Len64::L32 },
        0b1100_0011 => "DPD64", // => Ins::DuplicateData { len: Len64::L64 },
        0b1100_0100 => "CDS8",  // => Ins::CopyDataToSwap { len: Len64::L08 },
        0b1100_0101 => "CDS16", // => Ins::CopyDataToSwap { len: Len64::L16 },
        0b1100_0110 => "CDS32", // => Ins::CopyDataToSwap { len: Len64::L32 },
        0b1100_0111 => "CDS64", // => Ins::CopyDataToSwap { len: Len64::L64 },
        0b1100_1000 => "CDR8",  // => Ins::CopyDataToReturn { len: Len64::L08 },
        0b1100_1001 => "CDR16", // => Ins::CopyDataToReturn { len: Len64::L16 },
        0b1100_1010 => "CDR32", // => Ins::CopyDataToReturn { len: Len64::L32 },
        0b1100_1011 => "CDR64", // => Ins::CopyDataToReturn { len: Len64::L64 },
        0b1100_1100 => "CDH8",  // => Ins::CopyDataToHold { len: Len64::L08 },
        0b1100_1101 => "CDH16", // => Ins::CopyDataToHold { len: Len64::L16 },
        0b1100_1110 => "CDH32", // => Ins::CopyDataToHold { len: Len64::L32 },
        0b1100_1111 => "CDH64", // => Ins::CopyDataToHold { len: Len64::L64 },
        0b1101_0000 => "CSD8",  // => Ins::CopySwapToData { len: Len64::L08 },
        0b1101_0001 => "CSD16", // => Ins::CopySwapToData { len: Len64::L16 },
        0b1101_0010 => "CSD32", // => Ins::CopySwapToData { len: Len64::L32 },
        0b1101_0011 => "CSD64", // => Ins::CopySwapToData { len: Len64::L64 },
        0b1101_0100 => "DPS8",  // => Ins::DuplicateSwap { len: Len64::L08 },
        0b1101_0101 => "DPS16", // => Ins::DuplicateSwap { len: Len64::L16 },
        0b1101_0110 => "DPS32", // => Ins::DuplicateSwap { len: Len64::L32 },
        0b1101_0111 => "DPS64", // => Ins::DuplicateSwap { len: Len64::L64 },
        0b1101_1000 => "CSR8",  // => Ins::CopySwapToReturn { len: Len64::L08 },
        0b1101_1001 => "CSR16", // => Ins::CopySwapToReturn { len: Len64::L16 },
        0b1101_1010 => "CSR32", // => Ins::CopySwapToReturn { len: Len64::L32 },
        0b1101_1011 => "CSR64", // => Ins::CopySwapToReturn { len: Len64::L64 },
        0b1101_1100 => "CSH8",  // => Ins::CopySwapToHold { len: Len64::L08 },
        0b1101_1101 => "CSH16", // => Ins::CopySwapToHold { len: Len64::L16 },
        0b1101_1110 => "CSH32", // => Ins::CopySwapToHold { len: Len64::L32 },
        0b1101_1111 => "CSH64", // => Ins::CopySwapToHold { len: Len64::L64 },
        0b1110_0000 => "CRD8",  // => Ins::CopyReturnToData { len: Len64::L08 },
        0b1110_0001 => "CRD16", // => Ins::CopyReturnToData { len: Len64::L16 },
        0b1110_0010 => "CRD32", // => Ins::CopyReturnToData { len: Len64::L32 },
        0b1110_0011 => "CRD64", // => Ins::CopyReturnToData { len: Len64::L64 },
        0b1110_0100 => "CRS8",  // => Ins::CopyReturnToSwap { len: Len64::L08 },
        0b1110_0101 => "CRS16", // => Ins::CopyReturnToSwap { len: Len64::L16 },
        0b1110_0110 => "CRS32", // => Ins::CopyReturnToSwap { len: Len64::L32 },
        0b1110_0111 => "CRS64", // => Ins::CopyReturnToSwap { len: Len64::L64 },
        0b1110_1000 => "DPR8",  // => Ins::DuplicateReturn { len: Len64::L08 },
        0b1110_1001 => "DPR16", // => Ins::DuplicateReturn { len: Len64::L16 },
        0b1110_1010 => "DPR32", // => Ins::DuplicateReturn { len: Len64::L32 },
        0b1110_1011 => "DPR64", // => Ins::DuplicateReturn { len: Len64::L64 },
        0b1110_1100 => "CRH8",  // => Ins::CopyReturnToHold { len: Len64::L08 },
        0b1110_1101 => "CRH16", // => Ins::CopyReturnToHold { len: Len64::L16 },
        0b1110_1110 => "CRH32", // => Ins::CopyReturnToHold { len: Len64::L32 },
        0b1110_1111 => "CRH64", // => Ins::CopyReturnToHold { len: Len64::L64 },
        0b1111_0000 => "CHD8",  // => Ins::CopyHoldToData { len: Len64::L08 },
        0b1111_0001 => "CHD16", // => Ins::CopyHoldToData { len: Len64::L16 },
        0b1111_0010 => "CHD32", // => Ins::CopyHoldToData { len: Len64::L32 },
        0b1111_0011 => "CHD64", // => Ins::CopyHoldToData { len: Len64::L64 },
        0b1111_0100 => "CHS8",  // => Ins::CopyHoldToSwap { len: Len64::L08 },
        0b1111_0101 => "CHS16", // => Ins::CopyHoldToSwap { len: Len64::L16 },
        0b1111_0110 => "CHS32", // => Ins::CopyHoldToSwap { len: Len64::L32 },
        0b1111_0111 => "CHS64", // => Ins::CopyHoldToSwap { len: Len64::L64 },
        0b1111_1000 => "CHR8",  // => Ins::CopyHoldToReturn { len: Len64::L08 },
        0b1111_1001 => "CHR16", // => Ins::CopyHoldToReturn { len: Len64::L16 },
        0b1111_1010 => "CHR32", // => Ins::CopyHoldToReturn { len: Len64::L32 },
        0b1111_1011 => "CHR64", // => Ins::CopyHoldToReturn { len: Len64::L64 },
        0b1111_1100 => "DRD",   // => Ins::DropData,
        0b1111_1101 => "DRS",   // => Ins::DropSwap,
        0b1111_1110 => "DRR",   // => Ins::DropReturn,

        _ => "NOP",
    }
}
pub fn str_to_opcode(s: &str) -> Option<u8> {
    let byte = match s {
        // 0b00000_0000,
        // 0b00000_0001,
        // 0b00000_0010,
        // 0b00000_0011,
        "CAL8" => 0b000001_00,  // => Ins::Call { len: Len16::L8 },
        "CAL16" => 0b000001_01, // => Ins::Call { len: Len16::L16 },
        "RTN8" => 0b000001_10,  // => Ins::Return { len: Len16::L16 },
        "RTN16" => 0b000001_11, // => Ins::Return { len: Len16::L16 },
        "JMP8" => 0b00001_000,  //=> Ins::Jump { con: false, rel: false, len: Len16::L8, },
        "JMP16" => 0b00001_001, //=> Ins::Jump { con: false, rel: false, len: Len16::L16, },
        "JPR8" => 0b00001_010,  //=> Ins::Jump { con: false, rel: true, len: Len16::L8, },
        "JPR16" => 0b00001_011, //=> Ins::Jump { con: false, rel: true, len: Len16::L16, },
        "JPC8" => 0b00001_100,  //=> Ins::Jump { con: true, rel: false, len: Len16::L8, },
        "JPC16" => 0b00001_101, //=> Ins::Jump { con: true, rel: false, len: Len16::L16, },
        "JCR8" => 0b00001_110,  //=> Ins::Jump { con: true, rel: true, len: Len16::L8, },
        "JCR16" => 0b00001_111, //=> Ins::Jump { con: true, rel: true, len: Len16::L16, },
        "ADF32" => 0b0001_0000, // => Ins::AddF { len: LenF::L32 },
        "ADF64" => 0b0001_0001, // => Ins::AddF { len: LenF::L64 },
        "SBF32" => 0b0001_0010, // => Ins::SubtractF { len: LenF::L32 },
        "SBF64" => 0b0001_0011, // => Ins::SubtractF { len: LenF::L64 },
        "MLF32" => 0b0001_0100, // => Ins::MultiplyF { len: LenF::L32 },
        "MLF64" => 0b0001_0101, // => Ins::MultiplyF { len: LenF::L64 },
        "DVF32" => 0b0001_0110, // => Ins::DivideF { len: LenF::L32 },
        "DVF64" => 0b0001_0111, // => Ins::DivideF { len: LenF::L64 },
        "GRF32" => 0b0001_1000, // => Ins::GreaterF { len: LenF::L32 },
        "GRF64" => 0b0001_1001, // => Ins::GreaterF { len: LenF::L64 },
        "LSF32" => 0b0001_1010, // => Ins::LessF { len: LenF::L32 },
        "LSF64" => 0b0001_1011, // => Ins::LessF { len: LenF::L64 },
        // 0b0001_1100,
        // 0b0001_1101,
        // 0b0001_1110,
        // 0b0001_1111,
        // 0b001_00000,
        // 0b001_00001,
        // 0b001_00010,
        // 0b001_00011,
        // 0b001_00100,
        // 0b001_00101,
        // 0b001_00110,
        // 0b001_00111,
        // 0b001_01000,
        // 0b001_01001,
        // 0b001_01010,
        // 0b001_01011,
        // 0b001_01100,
        // 0b001_01101,
        // 0b001_01110,
        // 0b001_01111,
        // 0b001_10000,
        // 0b001_10001,
        // 0b001_10010,
        // 0b001_10011,
        // 0b001_10100,
        // 0b001_10101,
        // 0b001_10110,
        // 0b001_10111,
        // 0b001_11000,
        // 0b001_11001,
        // 0b001_11010,
        // 0b001_11011,
        // 0b001_11100,
        // 0b001_11101,
        // 0b001_11110,
        // 0b001_11111,
        "AND8" => 0b010_00000,  // => Ins::And { len: Len64::L08 },
        "AND16" => 0b010_00001, // => Ins::And { len: Len64::L16 },
        "AND32" => 0b010_00010, // => Ins::And { len: Len64::L32 },
        "AND64" => 0b010_00011, // => Ins::And { len: Len64::L64 },
        "OR8" => 0b010_00100,   // => Ins::Or { len: Len64::L08 },
        "OR16" => 0b010_00101,  // => Ins::Or { len: Len64::L16 },
        "OR32" => 0b010_00110,  // => Ins::Or { len: Len64::L32 },
        "OR64" => 0b010_00111,  // => Ins::Or { len: Len64::L64 },
        "XOR8" => 0b010_01000,  // => Ins::Xor { len: Len64::L08 },
        "XOR16" => 0b010_01001, // => Ins::Xor { len: Len64::L16 },
        "XOR32" => 0b010_01010, // => Ins::Xor { len: Len64::L32 },
        "XOR64" => 0b010_01011, // => Ins::Xor { len: Len64::L64 },
        "NOT8" => 0b010_01100,  // => Ins::Not { len: Len64::L08 },
        "NOT16" => 0b010_01101, // => Ins::Not { len: Len64::L16 },
        "NOT32" => 0b010_01110, // => Ins::Not { len: Len64::L32 },
        "NOT64" => 0b010_01111, // => Ins::Not { len: Len64::L64 },
        "BSL8" => 0b010_10000,  // => Ins::ShiftL { len: Len64::L08 },
        "BSL16" => 0b010_10001, // => Ins::ShiftL { len: Len64::L16 },
        "BSL32" => 0b010_10010, // => Ins::ShiftL { len: Len64::L32 },
        "BSL64" => 0b010_10011, // => Ins::ShiftL { len: Len64::L64 },
        "BSR8" => 0b010_10100,  // => Ins::ShiftR { len: Len64::L08 },
        "BSR16" => 0b010_10101, // => Ins::ShiftR { len: Len64::L16 },
        "BSR32" => 0b010_10110, // => Ins::ShiftR { len: Len64::L32 },
        "BSR64" => 0b010_10111, // => Ins::ShiftR { len: Len64::L64 },
        // 0b010_11000,
        // 0b010_11001,
        // 0b010_11010,
        // 0b010_11011,
        // 0b010_11100,
        // 0b010_11101,
        // 0b010_11110,
        // 0b010_11111,
        "ADD8" => 0b011_00000,       // => Ins::Add { len: Len64::L08 },
        "ADD16" => 0b011_00001,      // => Ins::Add { len: Len64::L16 },
        "ADD32" => 0b011_00010,      // => Ins::Add { len: Len64::L32 },
        "ADD64" => 0b011_00011,      // => Ins::Add { len: Len64::L64 },
        "SUB8" => 0b011_00100,       // => Ins::Subtract { len: Len64::L08 },
        "SUB16" => 0b011_00101,      // => Ins::Subtract { len: Len64::L16 },
        "SUB32" => 0b011_00110,      // => Ins::Subtract { len: Len64::L32 },
        "SUB64" => 0b011_00111,      // => Ins::Subtract { len: Len64::L64 },
        "MUL8" => 0b011_01000,       // => Ins::Multiply { len: Len64::L08 },
        "MUL16" => 0b011_01001,      // => Ins::Multiply { len: Len64::L16 },
        "MUL32" => 0b011_01010,      // => Ins::Multiply { len: Len64::L32 },
        "MUL64" => 0b011_01011,      // => Ins::Multiply { len: Len64::L64 },
        "DIV8" => 0b011_01100,       // => Ins::Divide { len: Len64::L08 },
        "DIV16" => 0b011_01101,      // => Ins::Divide { len: Len64::L16 },
        "DIV32" => 0b011_01110,      // => Ins::Divide { len: Len64::L32 },
        "DIV64" => 0b011_01111,      // => Ins::Divide { len: Len64::L64 },
        "GRT8" => 0b011_10000,       // => Ins::Greater { len: Len64::L08 },
        "GRT16" => 0b011_10001,      // => Ins::Greater { len: Len64::L16 },
        "GRT32" => 0b011_10010,      // => Ins::Greater { len: Len64::L32 },
        "GRT64" => 0b011_10011,      // => Ins::Greater { len: Len64::L64 },
        "LST8" => 0b011_10100,       // => Ins::Less { len: Len64::L08 },
        "LST16" => 0b011_10101,      // => Ins::Less { len: Len64::L16 },
        "LST32" => 0b011_10110,      // => Ins::Less { len: Len64::L32 },
        "LST64" => 0b011_10111,      // => Ins::Less { len: Len64::L64 },
        "EQU8" => 0b011_11000,       // => Ins::Equal { len: Len64::L08 },
        "EQU16" => 0b011_11001,      // => Ins::Equal { len: Len64::L16 },
        "EQU32" => 0b011_11010,      // => Ins::Equal { len: Len64::L32 },
        "EQU64" => 0b011_11011,      // => Ins::Equal { len: Len64::L64 },
        "NEQ8" => 0b011_11100,       // => Ins::NotEqual { len: Len64::L08 },
        "NEQ16" => 0b011_11101,      // => Ins::NotEqual { len: Len64::L16 },
        "NEQ32" => 0b011_11110,      // => Ins::NotEqual { len: Len64::L32 },
        "NEQ64" => 0b011_11111,      // => Ins::NotEqual { len: Len64::L64 },
        "DMA_TEST_1" => 0b1000_0000, // => Ins::DMARead,
        // 0b1000_0001,
        // 0b1000_0010,
        // 0b1000_0011,
        "DMA_TEST_2" => 0b1000_0100, // => Ins::DMAWrite { len: Len32::L08 },
        "DMA_TEST_3" => 0b1000_0101, // => Ins::DMAWrite { len: Len32::L16 },
        "DMA_TEST_4" => 0b1000_0110, // => Ins::DMAWrite { len: Len32::L32 },
        // 0b1000_0111,
        "DMA_TEST_5" => 0b1000_1000, // => Ins::DMAPoll,
        // 0b1000_1001,
        // 0b1000_1010,
        // 0b1000_1011,
        // 0b1000_1100,
        // 0b1000_1101,
        // 0b1000_1110,
        // 0b1000_1111,
        "DEVICE_TEST_0" => 0b1001_0000, // => Ins::DeviceRead { len: Len64::L08 },
        "DEVICE_TEST_1" => 0b1001_0001, // => Ins::DeviceRead { len: Len64::L16 },
        "DEVICE_TEST_2" => 0b1001_0010, // => Ins::DeviceRead { len: Len64::L32 },
        "DEVICE_TEST_3" => 0b1001_0011, // => Ins::DeviceRead { len: Len64::L64 },
        "DEVICE_TEST_4" => 0b1001_0100, // => Ins::DeviceWrite { len: Len64::L08 },
        "DEVICE_TEST_5" => 0b1001_0101, // => Ins::DeviceWrite { len: Len64::L16 },
        "DEVICE_TEST_6" => 0b1001_0110, // => Ins::DeviceWrite { len: Len64::L32 },
        "DEVICE_TEST_7" => 0b1001_0111, // => Ins::DeviceWrite { len: Len64::L64 },
        "DEVICE_TEST_8" => 0b1001_1000, // => Ins::DevicePoll { len: Len64::L08 },
        "DEVICE_TEST_9" => 0b1001_1001, // => Ins::DevicePoll { len: Len64::L16 },
        "DEVICE_TEST_A" => 0b1001_1010, // => Ins::DevicePoll { len: Len64::L32 },
        "DEVICE_TEST_B" => 0b1001_1011, // => Ins::DevicePoll { len: Len64::L64 },
        // 0b1001_1100,
        // 0b1001_1101,
        // 0b1001_1110,
        // 0b1001_1111,
        // 0b1010_0000,
        // 0b1010_0001,
        // 0b1010_0010,
        // 0b1010_0011,
        // 0b1010_0100,
        // 0b1010_0101,
        // 0b1010_0110,
        // 0b1010_0111,
        // 0b1010_1000,
        // 0b1010_1001,
        // 0b1010_1010,
        // 0b1010_1011,
        // 0b1010_1100,
        // 0b1010_1101,
        // 0b1010_1110,
        // 0b1010_1111,
        "LIT8" => 0b1011_0000,  // => Ins::Literal { len: Len64::L08 },
        "LIT16" => 0b1011_0001, // => Ins::Literal { len: Len64::L16 },
        "LIT32" => 0b1011_0010, // => Ins::Literal { len: Len64::L32 },
        "LIT64" => 0b1011_0011, // => Ins::Literal { len: Len64::L64 },
        "ADR8" => 0b1011_0100,  // => Ins::Address { len: Len64::L08 },
        "ADR16" => 0b1011_0101, // => Ins::Address { len: Len64::L16 },
        "ADR32" => 0b1011_0110, // => Ins::Address { len: Len64::L32 },
        "ADR64" => 0b1011_0111, // => Ins::Address { len: Len64::L64 },
        "STR8" => 0b1011_1000,  // => Ins::Store { len: Len64::L08 },
        "STR16" => 0b1011_1001, // => Ins::Store { len: Len64::L16 },
        "STR32" => 0b1011_1010, // => Ins::Store { len: Len64::L32 },
        "STR64" => 0b1011_1011, // => Ins::Store { len: Len64::L64 },
        "LOD8" => 0b1011_1100,  // => Ins::Load { len: Len64::L08 },
        "LOD16" => 0b1011_1101, // => Ins::Load { len: Len64::L16 },
        "LOD32" => 0b1011_1110, // => Ins::Load { len: Len64::L32 },
        "LOD64" => 0b1011_1111, // => Ins::Load { len: Len64::L64 },
        "DPD8" => 0b1100_0000,  // => Ins::DuplicateData { len: Len64::L08 },
        "DPD16" => 0b1100_0001, // => Ins::DuplicateData { len: Len64::L16 },
        "DPD32" => 0b1100_0010, // => Ins::DuplicateData { len: Len64::L32 },
        "DPD64" => 0b1100_0011, // => Ins::DuplicateData { len: Len64::L64 },
        "CDS8" => 0b1100_0100,  // => Ins::CopyDataToSwap { len: Len64::L08 },
        "CDS16" => 0b1100_0101, // => Ins::CopyDataToSwap { len: Len64::L16 },
        "CDS32" => 0b1100_0110, // => Ins::CopyDataToSwap { len: Len64::L32 },
        "CDS64" => 0b1100_0111, // => Ins::CopyDataToSwap { len: Len64::L64 },
        "CDR8" => 0b1100_1000,  // => Ins::CopyDataToReturn { len: Len64::L08 },
        "CDR16" => 0b1100_1001, // => Ins::CopyDataToReturn { len: Len64::L16 },
        "CDR32" => 0b1100_1010, // => Ins::CopyDataToReturn { len: Len64::L32 },
        "CDR64" => 0b1100_1011, // => Ins::CopyDataToReturn { len: Len64::L64 },
        "CDH8" => 0b1100_1100,  // => Ins::CopyDataToHold { len: Len64::L08 },
        "CDH16" => 0b1100_1101, // => Ins::CopyDataToHold { len: Len64::L16 },
        "CDH32" => 0b1100_1110, // => Ins::CopyDataToHold { len: Len64::L32 },
        "CDH64" => 0b1100_1111, // => Ins::CopyDataToHold { len: Len64::L64 },
        "CSD8" => 0b1101_0000,  // => Ins::CopySwapToData { len: Len64::L08 },
        "CSD16" => 0b1101_0001, // => Ins::CopySwapToData { len: Len64::L16 },
        "CSD32" => 0b1101_0010, // => Ins::CopySwapToData { len: Len64::L32 },
        "CSD64" => 0b1101_0011, // => Ins::CopySwapToData { len: Len64::L64 },
        "DPS8" => 0b1101_0100,  // => Ins::DuplicateSwap { len: Len64::L08 },
        "DPS16" => 0b1101_0101, // => Ins::DuplicateSwap { len: Len64::L16 },
        "DPS32" => 0b1101_0110, // => Ins::DuplicateSwap { len: Len64::L32 },
        "DPS64" => 0b1101_0111, // => Ins::DuplicateSwap { len: Len64::L64 },
        "CSR8" => 0b1101_1000,  // => Ins::CopySwapToReturn { len: Len64::L08 },
        "CSR16" => 0b1101_1001, // => Ins::CopySwapToReturn { len: Len64::L16 },
        "CSR32" => 0b1101_1010, // => Ins::CopySwapToReturn { len: Len64::L32 },
        "CSR64" => 0b1101_1011, // => Ins::CopySwapToReturn { len: Len64::L64 },
        "CSH8" => 0b1101_1100,  // => Ins::CopySwapToHold { len: Len64::L08 },
        "CSH16" => 0b1101_1101, // => Ins::CopySwapToHold { len: Len64::L16 },
        "CSH32" => 0b1101_1110, // => Ins::CopySwapToHold { len: Len64::L32 },
        "CSH64" => 0b1101_1111, // => Ins::CopySwapToHold { len: Len64::L64 },
        "CRD8" => 0b1110_0000,  // => Ins::CopyReturnToData { len: Len64::L08 },
        "CRD16" => 0b1110_0001, // => Ins::CopyReturnToData { len: Len64::L16 },
        "CRD32" => 0b1110_0010, // => Ins::CopyReturnToData { len: Len64::L32 },
        "CRD64" => 0b1110_0011, // => Ins::CopyReturnToData { len: Len64::L64 },
        "CRS8" => 0b1110_0100,  // => Ins::CopyReturnToSwap { len: Len64::L08 },
        "CRS16" => 0b1110_0101, // => Ins::CopyReturnToSwap { len: Len64::L16 },
        "CRS32" => 0b1110_0110, // => Ins::CopyReturnToSwap { len: Len64::L32 },
        "CRS64" => 0b1110_0111, // => Ins::CopyReturnToSwap { len: Len64::L64 },
        "DPR8" => 0b1110_1000,  // => Ins::DuplicateReturn { len: Len64::L08 },
        "DPR16" => 0b1110_1001, // => Ins::DuplicateReturn { len: Len64::L16 },
        "DPR32" => 0b1110_1010, // => Ins::DuplicateReturn { len: Len64::L32 },
        "DPR64" => 0b1110_1011, // => Ins::DuplicateReturn { len: Len64::L64 },
        "CRH8" => 0b1110_1100,  // => Ins::CopyReturnToHold { len: Len64::L08 },
        "CRH16" => 0b1110_1101, // => Ins::CopyReturnToHold { len: Len64::L16 },
        "CRH32" => 0b1110_1110, // => Ins::CopyReturnToHold { len: Len64::L32 },
        "CRH64" => 0b1110_1111, // => Ins::CopyReturnToHold { len: Len64::L64 },
        "CHD8" => 0b1111_0000,  // => Ins::CopyHoldToData { len: Len64::L08 },
        "CHD16" => 0b1111_0001, // => Ins::CopyHoldToData { len: Len64::L16 },
        "CHD32" => 0b1111_0010, // => Ins::CopyHoldToData { len: Len64::L32 },
        "CHD64" => 0b1111_0011, // => Ins::CopyHoldToData { len: Len64::L64 },
        "CHS8" => 0b1111_0100,  // => Ins::CopyHoldToSwap { len: Len64::L08 },
        "CHS16" => 0b1111_0101, // => Ins::CopyHoldToSwap { len: Len64::L16 },
        "CHS32" => 0b1111_0110, // => Ins::CopyHoldToSwap { len: Len64::L32 },
        "CHS64" => 0b1111_0111, // => Ins::CopyHoldToSwap { len: Len64::L64 },
        "CHR8" => 0b1111_1000,  // => Ins::CopyHoldToReturn { len: Len64::L08 },
        "CHR16" => 0b1111_1001, // => Ins::CopyHoldToReturn { len: Len64::L16 },
        "CHR32" => 0b1111_1010, // => Ins::CopyHoldToReturn { len: Len64::L32 },
        "CHR64" => 0b1111_1011, // => Ins::CopyHoldToReturn { len: Len64::L64 },
        "DRD" => 0b1111_1100,   // => Ins::DropData,
        "DRS" => 0b1111_1101,   // => Ins::DropSwap,
        "DRR" => 0b1111_1110,   // => Ins::DropReturn,

        _ => return None,
    };
    Some(byte)
}

impl std::fmt::Display for Ins {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        let s = match self {
            Ins::NoOperation => format!("NOP"),
            Ins::DuplicateData { len } => format!("DUP{} DATA", len),
            Ins::CopyDataToSwap { len } => format!("COPY{} DATA SWAP", len),
            Ins::CopyDataToReturn { len } => format!("COPY{} DATA RTRN", len),
            Ins::CopyDataToHold { len } => format!("COPY{} DATA HOLD", len),
            Ins::CopySwapToData { len } => format!("COPY{} SWAP DATA", len),
            Ins::DuplicateSwap { len } => format!("DUP{} SWAP", len),
            Ins::CopySwapToReturn { len } => format!("COPY{} SWAP RTRN", len),
            Ins::CopySwapToHold { len } => format!("COPY{} SWAP HOLD", len),
            Ins::CopyReturnToData { len } => format!("COPY{} RTRN DATA", len),
            Ins::CopyReturnToSwap { len } => format!("COPY{} RTRN SWAP", len),
            Ins::DuplicateReturn { len } => format!("DUP{} RTRN", len),
            Ins::CopyReturnToHold { len } => format!("COPY{} RTRN HOLD", len),
            Ins::CopyHoldToData { len } => format!("COPY{} HOLD DATA", len),
            Ins::CopyHoldToSwap { len } => format!("COPY{} HOLD SWAP", len),
            Ins::CopyHoldToReturn { len } => format!("COPY{} HOLD RTRN", len),
            Ins::DropData => format!("DROP DATA"),
            Ins::DropSwap => format!("DROP SWAP"),
            Ins::DropReturn => format!("DROP RTRN"),
            Ins::Jump { len, con, rel } => match con {
                true => match rel {
                    true => format!("JUMP{} REL COND", len),
                    false => format!("JUMP{} COND", len),
                },
                false => match rel {
                    true => format!("JUMP{} REL", len),
                    false => format!("JUMP{}", len),
                },
            },
            Ins::Call { len } => format!("CALL{}", len),
            Ins::Return { len } => format!("RTRN{}", len),
            Ins::Address { len } => format!("SET ADDR{}", len),
            Ins::Store { len } => format!("MEM STOR{}", len),
            Ins::Load { len } => format!("MEM LOAD{}", len),
            Ins::Literal { len } => format!("LIT{}", len),
            Ins::DMARead => format!("DMA READ"),
            Ins::DMAWrite { len } => format!("DMA WRIT{}", len),
            Ins::DMAPoll => format!("DMA POLL"),
            Ins::DeviceRead { len } => format!("DEV READ{}", len),
            Ins::DeviceWrite { len } => format!("DEV WRIT{}", len),
            Ins::DevicePoll { len } => format!("DEV POLL{}", len),
            Ins::Add { len } => format!("+{}", len),
            Ins::Subtract { len } => format!("-{}", len),
            Ins::Multiply { len } => format!("*{}", len),
            Ins::Divide { len } => format!("/{}", len),
            Ins::Greater { len } => format!(">{}", len),
            Ins::Less { len } => format!("<{}", len),
            Ins::Equal { len } => format!("=={}", len),
            Ins::NotEqual { len } => format!("!={}", len),
            Ins::AddF { len } => format!("+F{}", len),
            Ins::SubtractF { len } => format!("-F{}", len),
            Ins::MultiplyF { len } => format!("*F{}", len),
            Ins::DivideF { len } => format!("/F{}", len),
            Ins::GreaterF { len } => format!(">F{}", len),
            Ins::LessF { len } => format!("<F{}", len),
            Ins::And { len } => format!("&{}", len),
            Ins::Or { len } => format!("|{}", len),
            Ins::Xor { len } => format!("^{}", len),
            Ins::Not { len } => format!("!{}", len),
            Ins::ShiftL { len } => format!("<<{}", len),
            Ins::ShiftR { len } => format!(">>{}", len),
        };
        write!(f, "{}", s)
    }
}
